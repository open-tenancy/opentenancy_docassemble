#METADATA BLOCK
metadata:
  title: |
    openTenancy
  short title: |
    tenancy advice
  exit label: | 
    Back to Home Page
  url: |
      https://www.opentenancy.co.uk
  exit link: |
       https://www.opentenancy.co.uk

  show login: False
---
use objects: True
objects from file:
  - repairAdvice: repairadvice.json
  - questionFile: heatingquestions.json
---
#LOGIC BLOCK
mandatory: True
code: |
  if heatingIntro:
    #yes branch
    heatingEmergency
    if landlordEmergency: #inform landlord about emergency
      hasToldLandlord
      generateAdvice
      heatingStart = True
        
    else:
      informLandlordEmergency #tell them to let the landlord know
      generateAdvice
      heatingStart = True
  else:
    heatingNonEmergency
    reportingRepairsStart
    generateAdvice
    heatingStart = True
---
question: |
  Has your boiler completely stopped working?
field: heatingIntro
yesno: heatingIntro

---
include:
  - reportingRepairs.yml
---
question: |
  This is likely to be classed as an emergency and your landlord will have to respond within 24 hours, especially if during winter.
field: heatingEmergency

---
question: |
  You should inform your landlord as this is likely to be classed as an emergency. They should respond within 24 hours and resolve the issue, as this could be a hazard to health during winter.
field: informLandlordEmergency
---
question: |
  It is good that you have informed your landlord. They should respond within 24 hours and resolve the issue.
field: hasToldLandlord

---
question: |
  If you are starting to notice a problem with your heater but you still have heating, this will not be classed as an emergency. We recommend that you contact your landlord and let them know about the issue.
field: heatingNonEmergency

---
question: |
  Has your landlord responded to the repair request?
field: landlordEmergencyResponse
yesno: landlordEmergencyResponse
---
code: | #needs fixing
  emergencyDeadline = timeCheck.plus(hours = 24)
  hour = format_datetime(today().hour)
  if hour > emergencyDeadline: 
    emergencyDeadlinePassed = True
  else: 
    emergencyDeadlinePassed = False
---
question: |
  Have you informed your landlord about the boiler not working?
field: landlordEmergency
yesno: landlordEmergency
---
#EVENT BLOCK
event: generateAdvice
question: Please find below a summary of your interview from openTenancy.
attachments:
  - name: openTenancy Summary
    filename: openTenancySummary
    docx template file: test1.docx
    valid formats:
      - pdf    
      
      
